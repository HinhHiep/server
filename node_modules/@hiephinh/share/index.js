exports.isValidPhoneNumber = (phoneNumber) => {
    // Bắt đầu 03, 05, 07, 08, 09 và 10 số
    const regex = /^(03|05|07|08|09)\d{8}$/;
    return regex.test(phoneNumber);
}

exports.isValidPassword = (password) => {
    // Mật khẩu phải có ít nhất 8 ký tự, bao gồm chữ hoa, chữ thường, số và ký tự đặc biệt
    const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
    return regex.test(password);
}

exports.isValidEmail = (email) => {
    // Kiểm tra định dạng email
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return regex.test(email);
}

exports.isValidLogin = (phoneNumber, password) => {
    // Kiểm tra rỗng
    if (!phoneNumber) {
        const err = new Error()
        err.statusCode = 400
        err.message = 'Số điện thoại không được để trống'
        err.name = 'unvalidPhoneNumber'
        throw err
    }
    if (!password) {
        const err = new Error()
        err.statusCode = 400
        err.message = 'Mật khẩu không được để trống'
        err.name = 'unvalidPassword'
        throw err
    }
    // Kiểm tra định dạng số điện thoại và mật khẩu
    if (!this.isValidPhoneNumber(phoneNumber)) {
        const err = new Error()
        err.statusCode = 400
        err.message = 'Số điện thoại không hợp lệ'
        err.name = 'unvalidPhoneNumber'
        throw err
    }
    if (!this.isValidPassword(password)) {
        const err = new Error()
        err.statusCode = 400
        err.message = 'Mật khẩu không hợp lệ'
        err.name = 'unvalidPassword'
        throw err
    }
    return true
}
